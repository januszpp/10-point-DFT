%verification of the subsequent steps of the 10-point DFT algorithm
clc
clear 

syms x0 x1 x2 x3 x4 x5 x6 x7 x8 x9
syms X0 X1 X2 X3 X4 X5 X6 X7 X8 X9 
syms a0 a1 a2 a3 a4 a5 a6 a7 a8 a9
syms A0 A1 A2 A3 A4 A5 A6 A7 A8 A9

x = [x0; x1; x2; x3; x4; x5; x6; x7; x8; x9];
X = [X0; X1; X2; X3; X4; X5; X6; X7; X8; X9];
a = [a0; a1; a2; a3; a4; a5; a6; a7; a8; a9];
A = [A0; A1; A2; A3; A4; A5; A6; A7; A8; A9];

w10=exp(-j*2*pi/10)

W10=[];
for k=0:9
W10 = [W10; [w10^(k*0) w10^(k*1) w10^(k*2) w10^(k*3) w10^(k*4) w10^(k*5) w10^(k*6) w10^(k*7) w10^(k*8) w10^(k*9)]];
end
 
 V10=[1 0 0 0 0 0 0 0 0 0;
     0 1 0 0 0 0 0 0 0 1;
     0 0 1 0 0 0 0 0 1 0;
     0 0 0 1 0 0 0 1 0 0;
     0 0 0 0 1 0 1 0 0 0;
     0 0 0 0 0 1 0 0 0 0;
     0 0 0 0 1 0 -1 0 0 0;
     0 0 0 1 0 0 0 -1 0 0;
     0 0 1 0 0 0 0 0 -1 0;
     0 1 0 0 0 0 0 0 0 -1]
 

 W10_1=[W10(1,:);
    (W10(2,:)+W10(10,:))/2;
    (W10(3,:)+W10(9,:))/2;
    (W10(4,:)+W10(8,:))/2;
    (W10(5,:)+W10(7,:))/2;
    W10(6,:);
    (W10(5,:)-W10(7,:))/2;
    (W10(4,:)-W10(8,:))/2;
    (W10(3,:)-W10(9,:))/2;
    (W10(2,:)-W10(10,:))/2]

display('verification of the algorithm (8)')
 display(W10 - V10*W10_1)
 
 %% 

 W10_2 = [W10_1(:,1) ...
     [W10_1(:,2)+W10_1(:,10)]/2 [W10_1(:,3)+W10_1(:,9)]/2 [W10_1(:,4)+W10_1(:,8)]/2 [W10_1(:,5)+W10_1(:,7)]/2 ...
     [W10_1(:,6)] ...
     [W10_1(:,5)-W10_1(:,7)]/2 [W10_1(:,4)-W10_1(:,8)]/2  [W10_1(:,3)-W10_1(:,9)]/2 [W10_1(:,2)-W10_1(:,10)]/2]

display('verification of the algorithm (11)')
 display(W10 - V10*W10_2*V10)
 
 W10_1(1:6,1:6) - W10_2(1:6,1:6)
 W10_1(7:10,7:10) + W10_2(7:10,7:10)
 
  V10h=[1 0 0 0 0 1 0 0 0 0;
       0 1 0 0 1 0 0 0 0 0;
       0 0 1 1 0 0 0 0 0 0;
       0 0 1 -1 0 0 0 0 0 0;
       0 1 0 0 -1 0 0 0 0 0;
       1 0 0 0 0 -1 0 0 0 0;
       0 0 0 0 0 0 1 0 0 1;
       0 0 0 0 0 0 0 1 1 0;
       0 0 0 0 0 0 0 1 -1 0;
       0 0 0 0 0 0 1 0 0 -1]
V10h-2*(V10h^-1)

W10_3 = [(W10_2(1,:)+W10_2(6,:))/2;
         (W10_2(2,:)+W10_2(5,:))/2;
         (W10_2(3,:)+W10_2(4,:))/2;
        ( W10_2(3,:)-W10_2(4,:))/2;
         (W10_2(2,:)-W10_2(5,:))/2;
         (W10_2(1,:)-W10_2(6,:))/2;
         (W10_2(7,:)+W10_2(10,:))/2;         
         (W10_2(8,:)+W10_2(9,:))/2;         
         (W10_2(8,:)-W10_2(9,:))/2;
         (W10_2(7,:)-W10_2(10,:))/2]    
     
display('verification of the algorithm (13)')
 display(W10 - V10*V10h*W10_3*V10) 

 %%
 S10c = diag([1 1 1 -1 -1 1 1 1 1 -1])
 S10r = diag([1 1 -1 1 1 1 1 1 1 1])
 
W10_4 = S10r*W10_3*S10c

display('verification of the algorithm (14)')
display(W10 - V10*V10h*S10r*W10_4*S10c*V10) 


%wersja 1
T12x10=[1 0 0 0 0 0 0 0 0 0;
      0 0 1 0 1 0 0 0 0 0;
      0 0 1 0 -1 0 0 0 0 0;
      0 0 0 0 0 1 0 0 0 0;
      0 1 0 1 0 0 0 0 0 0;
      0 1 0 -1 0 0 0 0 0 0;
      0 0 0 0 0 0 0 -1 0 0;
      0 0 0 0 0 0 0 0 0 1;
      0 0 0 0 0 0 0 1 0 1;
      0 0 0 0 0 0 -1 0 0 0;
      0 0 0 0 0 0 0 0 1 0;
      0 0 0 0 0 0 1 0 1 0]
  
A14x12=[1 0 0 0 0 0 0 0 0 0 0 0;
     0 (a1+a2)/2 0 0 0 0 0 0 0 0 0 0;
     0 0 (a1-a2)/2 0 0 0 0 0 0 0 0 0;
     0 0 1 0 0 0 0 0 0 0 0 0;
     0 0 0 1 0 0 0 0 0 0 0 0;
     0 0 0 0 (a1+a2)/2 0 0 0 0 0 0 0;
     0 0 0 0 0 (a1-a2)/2 0 0 0 0 0 0;
     0 0 0 0 0 1 0 0 0 0 0 0;
     0 0 0 0 0 0 a3+a4 0 0 0 0 0;
     0 0 0 0 0 0 0 a3-a4 0 0 0 0;
     0 0 0 0 0 0 0 0 a4 0 0 0;
     0 0 0 0 0 0 0 0 0 a3+a4 0 0;
     0 0 0 0 0 0 0 0 0 0 a3-a4 0;
     0 0 0 0 0 0 0 0 0 0 0 a4]


T10x14 = [1 0 0 1 0 0 0 0 0 0 0 0 0 0;
        1 1 1 0 0 0 0 0 0 0 0 0 0 0;
       -1 1 -1 0 0 0 0 0 0 0 0 0 0 0;
        0 0 0 0 1 1 1 0 0 0 0 0 0 0;
        0 0 0 0 -1 1 -1 0 0 0 0 0 0 0;
        0 0 0 0 1 0 0 1 0 0 0 0 0 0;
        0 0 0 0 0 0 0 0 1 0 1 0 0 0;
        0 0 0 0 0 0 0 0 0 1 1 0 0 0;
        0 0 0 0 0 0 0 0 0 0 0 1 0 1;
        0 0 0 0 0 0 0 0 0 0 0 0 1 1]

display('verification of the algorithm (15)')
display(W10 - V10*V10h*S10r*T10x14*A14x12*T12x10*S10c*V10) 

%%
imag=1i
a1=cos(2*pi/5)
a2 = cos(pi/5)
a3 = imag*sin(2*pi/5)
a4 = imag*sin(pi/5)

A14x12=[1 0 0 0 0 0 0 0 0 0 0 0;
     0 (a1+a2)/2 0 0 0 0 0 0 0 0 0 0;
     0 0 (a1-a2)/2 0 0 0 0 0 0 0 0 0;
     0 0 1 0 0 0 0 0 0 0 0 0;
     0 0 0 1 0 0 0 0 0 0 0 0;
     0 0 0 0 (a1+a2)/2 0 0 0 0 0 0 0;
     0 0 0 0 0 (a1-a2)/2 0 0 0 0 0 0;
     0 0 0 0 0 1 0 0 0 0 0 0;
     0 0 0 0 0 0 a3+a4 0 0 0 0 0;
     0 0 0 0 0 0 0 a3-a4 0 0 0 0;
     0 0 0 0 0 0 0 0 a4 0 0 0;
     0 0 0 0 0 0 0 0 0 a3+a4 0 0;
     0 0 0 0 0 0 0 0 0 0 a3-a4 0;
     0 0 0 0 0 0 0 0 0 0 0 a4]

display('verification of the algorithm (15) for real values')
display(W10 - V10*V10h*S10r*T10x14*A14x12*T12x10*S10c*V10) 

